(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[841],{63:(e,t,r)=>{"use strict";var a=r(7260);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},2943:(e,t,r)=>{"use strict";r.d(t,{BO:()=>s,ES:()=>n,Tk:()=>l,Uz:()=>i});var a=r(598);let i=a.Ikc({title:a.YjP().min(1,"Title is required").max(200),body:a.YjP().min(1,"Body is required").max(5e3),tags:a.YOg(a.YjP()).default([]),sourceUrl:a.YjP().url().nullable().optional().default(null),visibility:a.k5n(["public","unlisted","private"]).default("public")});function l(e){let t=e.title.trim(),r=e.body.replace(/\r\n/g,"\n").trim(),a=Array.from(new Set((e.tags||[]).map(e=>e.trim().toLowerCase()))).sort();return{title:t,body:r,tags:a,sourceUrl:e.sourceUrl||null,visibility:e.visibility||"public"}}let n=a.Ikc({title:a.YjP().min(1,"Title is required").max(120),visibility:a.k5n(["public","private"]).default("private")});function s(e){return{title:e.title.trim(),visibility:e.visibility||"private"}}},4269:(e,t,r)=>{"use strict";r.d(t,{f:()=>i,l:()=>l});let a=["spamword1","nsfw"];function i(e){let t=(e||"").toLowerCase();for(let e of a)if(e&&t.includes(e))return e;return null}async function l(e){try{if(navigator.clipboard&&window.isSecureContext)return void await navigator.clipboard.writeText(e)}catch(e){}let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-9999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}finally{document.body.removeChild(t)}}},4585:(e,t,r)=>{"use strict";r.d(t,{Cy:()=>m,Lf:()=>f});var a=r(2078),i=r(2553),l=r(9708);r(9996);let n=null,s=null,o=!1,c={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"glyph-hub-5000.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"glyph-hub-5000",NEXT_PUBLIC_FIREBASE_APP_ID:"1:58219751174:web:18337f5441f6cf1f06a087"};function u(){return Object.entries(c).filter(e=>{let[,t]=e;return!t}).map(e=>{let[t]=e;return t})}function d(){return n||(0!==u().length?(o||(o=!0,console.warn("[firebase] Missing Firebase env vars. Add web/.env.local with NEXT_PUBLIC_ keys. Missing:",u())),null):n=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)({apiKey:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",authDomain:"glyph-hub-5000.firebaseapp.com",projectId:"glyph-hub-5000",storageBucket:"glyph-hub-5000.firebasestorage.app",messagingSenderId:"58219751174",appId:"1:58219751174:web:18337f5441f6cf1f06a087",measurementId:"G-N4T4Z5ZTL6"}))}function m(){let e=d();if(!e)return null;if(s)return s;try{s=(0,i.xI)(e)}catch(t){s=(0,i.Nu)(e,{persistence:[i.Gt,i.F0,i.iM]})}return s}function f(){let e=d();if(!e)return null;try{return(0,l._A)(e,{localCache:(0,l.vK)({tabManager:(0,l.K7)()})})}catch(t){return(0,l.aU)(e)}}},6056:(e,t)=>{!function(e){"undefined"==typeof DO_NOT_EXPORT_CRC?e(t):e({})}(function(e){e.version="1.2.2";var t=function(){for(var e=0,t=Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1,t[r]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),r=function(e){var t=0,r=0,a=0,i="undefined"!=typeof Int32Array?new Int32Array(4096):Array(4096);for(a=0;256!=a;++a)i[a]=e[a];for(a=0;256!=a;++a)for(r=e[a],t=256+a;t<4096;t+=256)r=i[t]=r>>>8^e[255&r];var l=[];for(a=1;16!=a;++a)l[a-1]="undefined"!=typeof Int32Array?i.subarray(256*a,256*a+256):i.slice(256*a,256*a+256);return l}(t),a=r[0],i=r[1],l=r[2],n=r[3],s=r[4],o=r[5],c=r[6],u=r[7],d=r[8],m=r[9],f=r[10],h=r[11],p=r[12],x=r[13],y=r[14];e.table=t,e.bstr=function(e,r){for(var a=-1^r,i=0,l=e.length;i<l;)a=a>>>8^t[(a^e.charCodeAt(i++))&255];return~a},e.buf=function(e,r){for(var v=-1^r,b=e.length-15,g=0;g<b;)v=y[e[g++]^255&v]^x[e[g++]^v>>8&255]^p[e[g++]^v>>16&255]^h[e[g++]^v>>>24]^f[e[g++]]^m[e[g++]]^d[e[g++]]^u[e[g++]]^c[e[g++]]^o[e[g++]]^s[e[g++]]^n[e[g++]]^l[e[g++]]^i[e[g++]]^a[e[g++]]^t[e[g++]];for(b+=15;g<b;)v=v>>>8^t[(v^e[g++])&255];return~v},e.str=function(e,r){for(var a=-1^r,i=0,l=e.length,n=0,s=0;i<l;)(n=e.charCodeAt(i++))<128?a=a>>>8^t[(a^n)&255]:n<2048?a=(a=a>>>8^t[(a^(192|n>>6&31))&255])>>>8^t[(a^(128|63&n))&255]:n>=55296&&n<57344?(n=(1023&n)+64,s=1023&e.charCodeAt(i++),a=(a=(a=(a=a>>>8^t[(a^(240|n>>8&7))&255])>>>8^t[(a^(128|n>>2&63))&255])>>>8^t[(a^(128|s>>6&15|(3&n)<<4))&255])>>>8^t[(a^(128|63&s))&255]):a=(a=(a=a>>>8^t[(a^(224|n>>12&15))&255])>>>8^t[(a^(128|n>>6&63))&255])>>>8^t[(a^(128|63&n))&255];return~a}})},7239:(e,t,r)=>{"use strict";r.d(t,{r:()=>c});var a=r(1210),i=r(2943),l=r(6056),n=r.n(l),s=r(5376).Buffer;let o={encode:e=>s.from(e).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")};function c(e){let t=JSON.stringify((0,i.Tk)(i.Uz.parse(e))),r=(0,a.Kc)(new TextEncoder().encode(t)),l=o.encode(r),s=(n().buf(r)>>>0).toString(16).padStart(8,"0");return"PB1.".concat(l,".").concat(s)}},8431:(e,t,r)=>{Promise.resolve().then(r.bind(r,8678))},8678:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var a=r(5155),i=r(2115),l=r(4585),n=r(9708),s=r(2619),o=r.n(s),c=r(7239),u=r(63),d=r(4269);function m(){var e;let t=(0,u.useParams)(),[r,s]=(0,i.useState)(null),[m,f]=(0,i.useState)([]),[h,p]=(0,i.useState)(""),[x,y]=(0,i.useState)(!1),v=!!(null==(e=(0,l.Cy)())?void 0:e.currentUser);(0,i.useEffect)(()=>{!async function(){let e,r=(0,l.Lf)();if(!r)return;let a=(0,n.H9)(r,"prompts",t.id);try{let t=performance.now();e=await (0,n.nY)(a);let r=performance.now();console.debug("[perf] prompt cache fetch ".concat(Math.round(r-t),"ms"))}catch(t){e=await (0,n._e)(a)}if(e.exists()){let t=e.data();s({id:e.id,title:t.title||"",body:t.body||"",tags:t.tags||[],sourceUrl:t.sourceUrl||null,visibility:t.visibility||"public",ownerId:t.ownerId,forkOf:t.forkOf,checksum:t.checksum});try{await (0,n.mZ)(a,{"stats.views":(0,n.GV)(1)})}catch(e){}}let i=(0,l.Cy)(),o=null==i?void 0:i.currentUser;o&&(f((await (0,n.GG)((0,n.P)((0,n.rJ)(r,"collections"),(0,n._M)("ownerId","==",o.uid)))).docs.map(e=>({id:e.id,title:e.data().title||""}))),y((await (0,n.x7)((0,n.H9)(r,"users",o.uid,"favorites",t.id))).exists()))}()},[t.id]);let b=(0,i.useMemo)(()=>{if(!(null==r?void 0:r.body))return[];let e=new Set;for(let t of r.body.matchAll(/\{\{([^}]+)\}\}/g))e.add(t[1].trim());return Array.from(e)},[r]),[g,w]=(0,i.useState)({}),[N,j]=(0,i.useState)(null),[k,C]=(0,i.useState)(!1);function I(e){return(e||"").replace(/\{\{([^}]+)\}\}/g,(e,t)=>{var r;return null!=(r=g[t.trim()])?r:"{{".concat(t,"}}")})}let A=(0,i.useMemo)(()=>r?(0,c.r)({title:r.title,body:I(r.body),tags:r.tags||[],sourceUrl:r.sourceUrl||null,visibility:r.visibility||"public"}):"",[r,g,I]);return r?(0,a.jsxs)("div",{className:"mx-auto max-w-[900px] py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsx)("h1",{className:"font-display text-2xl",children:r.title}),(0,a.jsxs)("div",{className:"relative z-50 flex gap-2 text-sm pointer-events-auto",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>C(e=>!e),className:"text-[var(--gh-text-muted)] hover:text-[var(--gh-cyan)] cursor-pointer","aria-haspopup":"menu","aria-expanded":k,type:"button",children:N?"Copied":"Copy"}),k&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-48 rounded-[10px] border border-[var(--gh-border)] bg-[var(--gh-surface)] shadow-[var(--gh-shadow-2)] py-1",onMouseLeave:()=>C(!1),role:"menu",children:[(0,a.jsx)("button",{className:"block w-full text-left px-3 py-2 text-sm text-[var(--gh-text-muted)] hover:text-[var(--gh-cyan)]",onClick:async()=>{await (0,d.l)(I(r.body)),j("prompt"),C(!1),setTimeout(()=>j(null),1500);try{let e=(0,l.Lf)();e&&await (0,n.mZ)((0,n.H9)(e,"prompts",t.id),{"stats.copies":(0,n.GV)(1)})}catch(e){}},role:"menuitem",children:"Copy Prompt"}),(0,a.jsx)("button",{className:"block w-full text-left px-3 py-2 text-sm text-[var(--gh-text-muted)] hover:text-[var(--gh-cyan)]",onClick:async()=>{let e=JSON.stringify({title:r.title,body:I(r.body),tags:r.tags||[],sourceUrl:r.sourceUrl||null,visibility:r.visibility||"public"});await (0,d.l)(e),j("json"),C(!1),setTimeout(()=>j(null),1500)},role:"menuitem",children:"Copy JSON"}),(0,a.jsx)("button",{className:"block w-full text-left px-3 py-2 text-sm text-[var(--gh-text-muted)] hover:text-[var(--gh-cyan)]",onClick:async()=>{await (0,d.l)(A),j("code"),C(!1),setTimeout(()=>j(null),1500)},role:"menuitem",children:"Copy Share Code"}),(0,a.jsx)("button",{className:"block w-full text-left px-3 py-2 text-sm text-[var(--gh-text-muted)] hover:text-[var(--gh-cyan)]",onClick:async()=>{let e='<iframe src="'.concat(window.location.origin,"/embed/p/").concat(t.id,'" width="600" height="200" frameborder="0" style="max-width:100%;"></iframe>');await (0,d.l)(e),j("embed"),C(!1),setTimeout(()=>j(null),1500)},role:"menuitem",children:"Copy Embed"})]})]}),(0,a.jsx)(o(),{href:"/p/".concat(t.id),className:"text-[var(--gh-text-muted)] hover:text-[var(--gh-cyan)]",children:"Share URL"}),(()=>{var e,i;let n=(0,l.Cy)(),s=null==n||null==(e=n.currentUser)?void 0:e.uid;return(null==n||null==(i=n.currentUser)||i.email,s&&r.ownerId===s)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o(),{href:"/p/".concat(t.id,"/edit"),className:"text-[var(--gh-cyan)]",children:"Edit"}),(0,a.jsx)(o(),{href:"/p/".concat(t.id,"/versions"),className:"text-[var(--gh-cyan)]",children:"Versions"})]}):null})(),v&&(0,a.jsx)("button",{onClick:async()=>{try{let e=(0,l.Lf)(),r=(0,l.Cy)(),a=null==r?void 0:r.currentUser;if(!e||!a)return;let i=(0,n.H9)(e,"users",a.uid,"favorites",t.id);x?(await (0,n.kd)(i),y(!1),await (0,n.mZ)((0,n.H9)(e,"prompts",t.id),{"stats.likes":(0,n.GV)(-1)})):(await (0,n.BN)(i,{promptId:t.id,createdAt:new Date}),y(!0),await (0,n.mZ)((0,n.H9)(e,"prompts",t.id),{"stats.likes":(0,n.GV)(1)}))}catch(e){}},className:"".concat(x?"text-[var(--gh-cyan)]":"text-[var(--gh-text-muted)] hover:text-[var(--gh-cyan)]"," pointer-events-auto"),children:x?"★ Liked":"☆ Like"}),v&&(0,a.jsx)("button",{onClick:async()=>{try{let e=(0,l.Lf)(),a=(0,l.Cy)(),i=null==a?void 0:a.currentUser;if(!e||!i||!r)return;let s=(0,n.H9)((0,n.rJ)(e,"prompts"));await (0,n.BN)(s,{title:r.title,body:r.body,tags:r.tags||[],sourceUrl:r.sourceUrl||null,visibility:"private",ownerId:i.uid,forkOf:t.id,checksum:r.checksum||"fork",stats:{views:0,copies:0,likes:0},createdAt:(0,n.O5)(),updatedAt:(0,n.O5)()}),window.location.href="/p/".concat(s.id)}catch(e){}},className:"text-[var(--gh-text-muted)] hover:text-[var(--gh-cyan)] pointer-events-auto",children:"Fork"}),(()=>{var e,i;let s=(0,l.Cy)(),o=null==s||null==(e=s.currentUser)?void 0:e.uid,c=(null==s||null==(i=s.currentUser)?void 0:i.email)||"";return o&&(r.ownerId===o||"outersloth@gmail.com"===c)?(0,a.jsx)("button",{onClick:async()=>{if(confirm("Delete this prompt? This cannot be undone."))try{let e=(0,l.Lf)();if(!e)return;await (0,n.kd)((0,n.H9)(e,"prompts",t.id)),window.location.href="/"}catch(e){}},className:"text-red-400 ml-2",type:"button",children:"Delete"}):null})()]})]}),v&&m.length>0&&(0,a.jsxs)("div",{className:"mt-3 text-sm flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-[var(--gh-text-muted)]",children:"Add to collection:"}),(0,a.jsxs)("select",{className:"rounded-[10px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-2 py-1",onChange:async e=>{let r=e.target.value;if(r)try{p("Adding...");let e=(0,l.Lf)();if(!e)throw Error("No DB");await (0,n.BN)((0,n.H9)(e,"collections",r,"items",t.id),{promptId:t.id,addedAt:new Date}),p("Added")}catch(e){p(e instanceof Error?e.message:"Failed")}},defaultValue:"",children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"Select collection"}),m.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]}),h&&(0,a.jsx)("span",{className:"text-[var(--gh-text-muted)]",children:h})]}),(0,a.jsxs)("div",{className:"mt-4 text-[var(--gh-text-dim)] text-sm",children:["Visibility: ",r.visibility,r.forkOf&&(0,a.jsxs)(a.Fragment,{children:[" • ",(0,a.jsx)("span",{children:"Forked from "}),(0,a.jsx)(o(),{className:"text-[var(--gh-cyan)] underline",href:"/p/".concat(r.forkOf),children:r.forkOf})]}),r.sourceUrl&&(0,a.jsxs)(a.Fragment,{children:[" • ",(0,a.jsx)("a",{href:r.sourceUrl,target:"_blank",rel:"noreferrer",className:"underline text-[var(--gh-cyan)]",children:"source"})]})]}),b.length>0&&(0,a.jsx)("div",{className:"mt-6 grid gap-3 sm:grid-cols-2",children:b.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs mb-1 text-[var(--gh-text-muted)]",children:e}),(0,a.jsx)("input",{value:g[e]||"",onChange:t=>w({...g,[e]:t.target.value}),className:"w-full rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm",placeholder:"Enter ".concat(e)})]},e))}),(0,a.jsx)("pre",{className:"mt-6 p-4 rounded-[12px] bg-[var(--gh-bg-soft)] border border-[var(--gh-border)] whitespace-pre-wrap text-sm",children:I(r.body)}),Array.isArray(r.tags)&&r.tags.length>0&&(0,a.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:r.tags.map(e=>(0,a.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full bg-[var(--gh-bg-soft)] border border-[var(--gh-border)] text-[var(--gh-text-muted)]",children:["#",e]},e))})]}):(0,a.jsx)("div",{className:"py-8",children:"Loading…"})}}},e=>{e.O(0,[135,965,33,31,619,598,441,255,358],()=>e(e.s=8431)),_N_E=e.O()}]);