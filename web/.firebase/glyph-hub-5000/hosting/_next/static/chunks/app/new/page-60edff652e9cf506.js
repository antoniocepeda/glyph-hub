(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[359],{2943:(e,t,r)=>{"use strict";r.d(t,{BO:()=>o,ES:()=>l,Tk:()=>i,Uz:()=>a});var n=r(598);let a=n.Ikc({title:n.YjP().min(1,"Title is required").max(200),body:n.YjP().min(1,"Body is required").max(5e3),tags:n.YOg(n.YjP()).default([]),sourceUrl:n.YjP().url().nullable().optional().default(null),visibility:n.k5n(["public","unlisted","private"]).default("public")});function i(e){let t=e.title.trim(),r=e.body.replace(/\r\n/g,"\n").trim(),n=Array.from(new Set((e.tags||[]).map(e=>e.trim().toLowerCase()))).sort();return{title:t,body:r,tags:n,sourceUrl:e.sourceUrl||null,visibility:e.visibility||"public"}}let l=n.Ikc({title:n.YjP().min(1,"Title is required").max(120),visibility:n.k5n(["public","private"]).default("private")});function o(e){return{title:e.title.trim(),visibility:e.visibility||"private"}}},4152:(e,t,r)=>{"use strict";r.d(t,{d_:()=>a});let n=e=>crypto.getRandomValues(new Uint8Array(e)),a=(e,t=21)=>((e,t,r)=>{let n=(2<<Math.log2(e.length-1))-1,a=-~(1.6*n*t/e.length);return (i=t)=>{let l="";for(;;){let t=r(a),o=0|a;for(;o--;)if((l+=e[t[o]&n]||"").length>=i)return l}}})(e,0|t,n)},4269:(e,t,r)=>{"use strict";r.d(t,{f:()=>a,l:()=>i});let n=["spamword1","nsfw"];function a(e){let t=(e||"").toLowerCase();for(let e of n)if(e&&t.includes(e))return e;return null}async function i(e){try{if(navigator.clipboard&&window.isSecureContext)return void await navigator.clipboard.writeText(e)}catch(e){}let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-9999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}finally{document.body.removeChild(t)}}},4585:(e,t,r)=>{"use strict";r.d(t,{Cy:()=>p,Lf:()=>h,c7:()=>g});var n=r(2078),a=r(2553),i=r(9708),l=r(9996);let o=null,s=null,c=!1,u={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"glyph-hub-5000.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"glyph-hub-5000",NEXT_PUBLIC_FIREBASE_APP_ID:"1:58219751174:web:18337f5441f6cf1f06a087"};function d(){return Object.entries(u).filter(e=>{let[,t]=e;return!t}).map(e=>{let[t]=e;return t})}function f(){return o||(0!==d().length?(c||(c=!0,console.warn("[firebase] Missing Firebase env vars. Add web/.env.local with NEXT_PUBLIC_ keys. Missing:",d())),null):o=(0,n.Dk)().length?(0,n.Sx)():(0,n.Wp)({apiKey:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",authDomain:"glyph-hub-5000.firebaseapp.com",projectId:"glyph-hub-5000",storageBucket:"glyph-hub-5000.firebasestorage.app",messagingSenderId:"58219751174",appId:"1:58219751174:web:18337f5441f6cf1f06a087",measurementId:"G-N4T4Z5ZTL6"}))}function p(){let e=f();if(!e)return null;if(s)return s;try{s=(0,a.xI)(e)}catch(t){s=(0,a.Nu)(e,{persistence:[a.Gt,a.F0,a.iM]})}return s}function h(){let e=f();if(!e)return null;try{return(0,i._A)(e,{localCache:(0,i.vK)({tabManager:(0,i.K7)()})})}catch(t){return(0,i.aU)(e)}}function g(){let e=f();return e?(0,l.c7)(e):null}},5957:(e,t,r)=>{Promise.resolve().then(r.bind(r,7534))},6056:(e,t)=>{!function(e){"undefined"==typeof DO_NOT_EXPORT_CRC?e(t):e({})}(function(e){e.version="1.2.2";var t=function(){for(var e=0,t=Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1,t[r]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),r=function(e){var t=0,r=0,n=0,a="undefined"!=typeof Int32Array?new Int32Array(4096):Array(4096);for(n=0;256!=n;++n)a[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=a[t]=r>>>8^e[255&r];var i=[];for(n=1;16!=n;++n)i[n-1]="undefined"!=typeof Int32Array?a.subarray(256*n,256*n+256):a.slice(256*n,256*n+256);return i}(t),n=r[0],a=r[1],i=r[2],l=r[3],o=r[4],s=r[5],c=r[6],u=r[7],d=r[8],f=r[9],p=r[10],h=r[11],g=r[12],b=r[13],m=r[14];e.table=t,e.bstr=function(e,r){for(var n=-1^r,a=0,i=e.length;a<i;)n=n>>>8^t[(n^e.charCodeAt(a++))&255];return~n},e.buf=function(e,r){for(var y=-1^r,x=e.length-15,v=0;v<x;)y=m[e[v++]^255&y]^b[e[v++]^y>>8&255]^g[e[v++]^y>>16&255]^h[e[v++]^y>>>24]^p[e[v++]]^f[e[v++]]^d[e[v++]]^u[e[v++]]^c[e[v++]]^s[e[v++]]^o[e[v++]]^l[e[v++]]^i[e[v++]]^a[e[v++]]^n[e[v++]]^t[e[v++]];for(x+=15;v<x;)y=y>>>8^t[(y^e[v++])&255];return~y},e.str=function(e,r){for(var n=-1^r,a=0,i=e.length,l=0,o=0;a<i;)(l=e.charCodeAt(a++))<128?n=n>>>8^t[(n^l)&255]:l<2048?n=(n=n>>>8^t[(n^(192|l>>6&31))&255])>>>8^t[(n^(128|63&l))&255]:l>=55296&&l<57344?(l=(1023&l)+64,o=1023&e.charCodeAt(a++),n=(n=(n=(n=n>>>8^t[(n^(240|l>>8&7))&255])>>>8^t[(n^(128|l>>2&63))&255])>>>8^t[(n^(128|o>>6&15|(3&l)<<4))&255])>>>8^t[(n^(128|63&o))&255]):n=(n=(n=n>>>8^t[(n^(224|l>>12&15))&255])>>>8^t[(n^(128|l>>6&63))&255])>>>8^t[(n^(128|63&l))&255];return~n}})},7239:(e,t,r)=>{"use strict";r.d(t,{r:()=>c});var n=r(1210),a=r(2943),i=r(6056),l=r.n(i),o=r(5376).Buffer;let s={encode:e=>o.from(e).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")};function c(e){let t=JSON.stringify((0,a.Tk)(a.Uz.parse(e))),r=(0,n.Kc)(new TextEncoder().encode(t)),i=s.encode(r),o=(l().buf(r)>>>0).toString(16).padStart(8,"0");return"PB1.".concat(i,".").concat(o)}},7534:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var n=r(5155),a=r(2115),i=r(598),l=r(2943),o=r(8875),s=r(4585),c=r(9708),u=r(4152),d=r(7239),f=r(4269),p=r(7886);let h=(0,u.d_)("0123456789abcdefghijklmnopqrstuvwxyz",10);function g(){var e;let[t,r]=(0,a.useState)({title:"",body:"",tags:[],sourceUrl:null,visibility:"public"}),[u,g]=(0,a.useState)(null),[b,m]=(0,a.useState)(!1),[y,x]=(0,a.useState)(null);async function v(e){e.preventDefault(),g(null),m(!0);try{let e=(0,s.Cy)(),r=null==e?void 0:e.currentUser;if(r||(r=await (0,p.XC)()),!r)return void g("Unable to create prompt. Sign in or enable anonymous auth.");let n=l.Uz.parse(t),a=(0,l.Tk)(n),i=(0,o.n)(a.body),u=(0,f.f)(a.body);if(u)throw Error("Content not allowed: ".concat(u));let b=h(),m=(0,s.Lf)();if(!m)throw Error("Firebase is not configured. Add .env.local");if(!(await (0,c.GG)((0,c.P)((0,c.rJ)(m,"prompts"),(0,c._M)("checksum","==",i)))).empty)throw Error("A similar prompt already exists. Consider forking it.");let y=(0,c.H9)((0,c.rJ)(m,"prompts"),b);await (0,c.BN)(y,{...a,ownerId:r.uid,checksum:i,stats:{views:0,copies:0,likes:0},createdAt:(0,c.O5)(),updatedAt:(0,c.O5)()}),await (0,c.BN)((0,c.H9)(m,"users",r.uid),{lastCreateAt:(0,c.O5)()},{merge:!0});let v=(0,d.r)(a);x(v)}catch(e){if(e instanceof i.GaX){var r;g((null==(r=e.issues[0])?void 0:r.message)||"Validation error")}else e instanceof Error?g(e.message):g("Unknown error")}finally{m(!1)}}return(0,n.jsxs)("div",{className:"mx-auto max-w-[900px] py-8",children:[(0,n.jsx)("h1",{className:"font-display text-2xl mb-4",children:"New Prompt"}),(()=>{{let e=sessionStorage.getItem("gh_new_prompt_draft");if(e)try{let n=JSON.parse(e);sessionStorage.removeItem("gh_new_prompt_draft"),t.title||t.body||r({title:n.title||"",body:n.body||"",tags:Array.isArray(n.tags)?n.tags:[],sourceUrl:n.sourceUrl||null,visibility:n.visibility||"public"})}catch(e){}}return null})(),(0,n.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm mb-1",children:"Title"}),(0,n.jsx)("input",{className:"w-full rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm placeholder:text-[var(--gh-text-muted)] focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/50",value:t.title,onChange:e=>r({...t,title:e.target.value}),placeholder:"Short title"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm mb-1",children:"Body"}),(0,n.jsx)("textarea",{className:"w-full min-h-[200px] rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm placeholder:text-[var(--gh-text-muted)] focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/50",value:t.body,onChange:e=>r({...t,body:e.target.value}),placeholder:"Paste the prompt..."})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm mb-1",children:"Tags (comma separated)"}),(0,n.jsx)("input",{className:"w-full rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm placeholder:text-[var(--gh-text-muted)] focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/50",value:t.tags.join(", "),onChange:e=>r({...t,tags:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)}),placeholder:"writing, brainstorming"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm mb-1",children:"Source URL (optional)"}),(0,n.jsx)("input",{className:"w-full rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm placeholder:text-[var(--gh-text-muted)] focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/50",value:null!=(e=t.sourceUrl)?e:"",onChange:e=>r({...t,sourceUrl:e.target.value||null}),placeholder:"https://..."})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm mb-1",children:"Visibility"}),(0,n.jsxs)("select",{className:"w-full rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/50",value:t.visibility,onChange:e=>r({...t,visibility:e.target.value}),children:[(0,n.jsx)("option",{value:"public",children:"Public"}),(0,n.jsx)("option",{value:"unlisted",children:"Unlisted"}),(0,n.jsx)("option",{value:"private",children:"Private"})]})]})]}),u&&(0,n.jsx)("p",{className:"text-red-400 text-sm",children:u}),(0,n.jsx)("button",{type:"submit",disabled:b,className:"inline-flex items-center gap-2 rounded-[12px] px-4 py-2 text-sm font-medium transition bg-[var(--gh-cyan)] text-black hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/60",children:b?"Savingâ€¦":"Save Prompt"})]}),y&&(0,n.jsxs)("div",{className:"mt-6 p-4 rounded-[12px] bg-[var(--gh-bg-soft)] border border-[var(--gh-border)]",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("h2",{className:"text-sm text-[var(--gh-text-dim)]",children:"Share Code"}),(0,n.jsx)("button",{onClick:()=>navigator.clipboard.writeText(y),className:"text-sm text-[var(--gh-cyan)]",children:"Copy"})]}),(0,n.jsx)("pre",{className:"overflow-x-auto text-sm",children:y})]})]})}},7886:(e,t,r)=>{"use strict";r.d(t,{CI:()=>c,NE:()=>o,XC:()=>u,mu:()=>s});var n=r(4585),a=r(2553),i=r(9708);async function l(e){let t=(0,n.Lf)();if(!t)return;let r=(0,i.H9)(t,"users",e.uid);(await (0,i.x7)(r)).exists()||await (0,i.BN)(r,{displayName:e.displayName||"",photoURL:e.photoURL||"",emailLower:(e.email||"").toLowerCase(),bio:"",createdAt:(0,i.O5)(),promptCount:0,likeCount:0})}async function o(e,t){let r=(0,n.Cy)();if(!r)throw console.warn("[auth] registerWithEmailPassword: no auth instance; possibly missing env"),Error("Firebase is not configured. Add .env.local");let i=await (0,a.eJ)(r,e,t);return await l(i.user),i.user}async function s(e,t){let r=(0,n.Cy)();if(!r)throw console.warn("[auth] signInWithEmailPassword: no auth instance; possibly missing env"),Error("Firebase is not configured. Add .env.local");let i=await (0,a.x9)(r,e,t);return await l(i.user),i.user}async function c(){let e=(0,n.Cy)();if(!e)return void console.debug("[auth] signOut: no auth instance; ignoring");await (0,a.CI)(e)}async function u(){let e=(0,n.Cy)();if(!e)return null;if(e.currentUser)return e.currentUser;try{return(await (0,a.zK)(e)).user}catch(e){return console.warn("[auth] Anonymous sign-in failed. Enable Anonymous provider in Firebase console.",e),null}}},8875:(e,t,r)=>{"use strict";function n(e){let t=0x811c9dc5;for(let r=0;r<e.length;r++)t^=e.charCodeAt(r),t=(t>>>0)*0x1000193>>>0;return(t>>>0).toString(16).padStart(8,"0")}r.d(t,{n:()=>n})}},e=>{e.O(0,[135,965,33,31,598,441,255,358],()=>e(e.s=5957)),_N_E=e.O()}]);