(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[841],{63:(e,t,r)=>{"use strict";var a=r(7260);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},2943:(e,t,r)=>{"use strict";r.d(t,{BO:()=>l,ES:()=>s,Tk:()=>n,Uz:()=>i});var a=r(598);let i=a.Ikc({title:a.YjP().min(1,"Title is required").max(200),body:a.YjP().min(1,"Body is required").max(5e3),tags:a.YOg(a.YjP()).default([]),sourceUrl:a.YjP().url().nullable().optional().default(null),visibility:a.k5n(["public","unlisted","private"]).default("public")});function n(e){let t=e.title.trim(),r=e.body.replace(/\r\n/g,"\n").trim(),a=Array.from(new Set((e.tags||[]).map(e=>e.trim().toLowerCase()))).sort();return{title:t,body:r,tags:a,sourceUrl:e.sourceUrl||null,visibility:e.visibility||"public"}}let s=a.Ikc({title:a.YjP().min(1,"Title is required").max(120),visibility:a.k5n(["public","private"]).default("private")});function l(e){return{title:e.title.trim(),visibility:e.visibility||"private"}}},4269:(e,t,r)=>{"use strict";r.d(t,{f:()=>i,l:()=>n});let a=["spamword1","nsfw"];function i(e){let t=(e||"").toLowerCase();for(let e of a)if(e&&t.includes(e))return e;return null}async function n(e){try{if(navigator.clipboard&&window.isSecureContext)return void await navigator.clipboard.writeText(e)}catch(e){}let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-9999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}finally{document.body.removeChild(t)}}},4585:(e,t,r)=>{"use strict";r.d(t,{Cy:()=>f,Lf:()=>p});var a=r(2078),i=r(2553),n=r(9708);r(9996);let s=null,l=null,c=!1,o={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"glyph-hub-5000.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"glyph-hub-5000",NEXT_PUBLIC_FIREBASE_APP_ID:"1:58219751174:web:18337f5441f6cf1f06a087"};function d(){return Object.entries(o).filter(e=>{let[,t]=e;return!t}).map(e=>{let[t]=e;return t})}function u(){return s||(0!==d().length?(c||(c=!0,console.warn("[firebase] Missing Firebase env vars. Add web/.env.local with NEXT_PUBLIC_ keys. Missing:",d())),null):s=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)({apiKey:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",authDomain:"glyph-hub-5000.firebaseapp.com",projectId:"glyph-hub-5000",storageBucket:"glyph-hub-5000.firebasestorage.app",messagingSenderId:"58219751174",appId:"1:58219751174:web:18337f5441f6cf1f06a087",measurementId:"G-N4T4Z5ZTL6"}))}function f(){let e=u();if(!e)return null;if(l)return l;try{l=(0,i.xI)(e)}catch(t){l=(0,i.Nu)(e,{persistence:[i.Gt,i.F0,i.iM]})}return l}function p(){let e=u();if(!e)return null;try{return(0,n._A)(e,{localCache:(0,n.vK)({tabManager:(0,n.K7)()})})}catch(t){return(0,n.aU)(e)}}},6056:(e,t)=>{!function(e){"undefined"==typeof DO_NOT_EXPORT_CRC?e(t):e({})}(function(e){e.version="1.2.2";var t=function(){for(var e=0,t=Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1,t[r]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),r=function(e){var t=0,r=0,a=0,i="undefined"!=typeof Int32Array?new Int32Array(4096):Array(4096);for(a=0;256!=a;++a)i[a]=e[a];for(a=0;256!=a;++a)for(r=e[a],t=256+a;t<4096;t+=256)r=i[t]=r>>>8^e[255&r];var n=[];for(a=1;16!=a;++a)n[a-1]="undefined"!=typeof Int32Array?i.subarray(256*a,256*a+256):i.slice(256*a,256*a+256);return n}(t),a=r[0],i=r[1],n=r[2],s=r[3],l=r[4],c=r[5],o=r[6],d=r[7],u=r[8],f=r[9],p=r[10],m=r[11],h=r[12],y=r[13],b=r[14];e.table=t,e.bstr=function(e,r){for(var a=-1^r,i=0,n=e.length;i<n;)a=a>>>8^t[(a^e.charCodeAt(i++))&255];return~a},e.buf=function(e,r){for(var x=-1^r,v=e.length-15,g=0;g<v;)x=b[e[g++]^255&x]^y[e[g++]^x>>8&255]^h[e[g++]^x>>16&255]^m[e[g++]^x>>>24]^p[e[g++]]^f[e[g++]]^u[e[g++]]^d[e[g++]]^o[e[g++]]^c[e[g++]]^l[e[g++]]^s[e[g++]]^n[e[g++]]^i[e[g++]]^a[e[g++]]^t[e[g++]];for(v+=15;g<v;)x=x>>>8^t[(x^e[g++])&255];return~x},e.str=function(e,r){for(var a=-1^r,i=0,n=e.length,s=0,l=0;i<n;)(s=e.charCodeAt(i++))<128?a=a>>>8^t[(a^s)&255]:s<2048?a=(a=a>>>8^t[(a^(192|s>>6&31))&255])>>>8^t[(a^(128|63&s))&255]:s>=55296&&s<57344?(s=(1023&s)+64,l=1023&e.charCodeAt(i++),a=(a=(a=(a=a>>>8^t[(a^(240|s>>8&7))&255])>>>8^t[(a^(128|s>>2&63))&255])>>>8^t[(a^(128|l>>6&15|(3&s)<<4))&255])>>>8^t[(a^(128|63&l))&255]):a=(a=(a=a>>>8^t[(a^(224|s>>12&15))&255])>>>8^t[(a^(128|s>>6&63))&255])>>>8^t[(a^(128|63&s))&255];return~a}})},7239:(e,t,r)=>{"use strict";r.d(t,{r:()=>o});var a=r(1210),i=r(2943),n=r(6056),s=r.n(n),l=r(5376).Buffer;let c={encode:e=>l.from(e).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")};function o(e){let t=JSON.stringify((0,i.Tk)(i.Uz.parse(e))),r=(0,a.Kc)(new TextEncoder().encode(t)),n=c.encode(r),l=(s().buf(r)>>>0).toString(16).padStart(8,"0");return"PB1.".concat(n,".").concat(l)}},8431:(e,t,r)=>{Promise.resolve().then(r.bind(r,8678))},8678:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var a=r(5155),i=r(2115),n=r(4585),s=r(9708),l=r(2619),c=r.n(l),o=r(7239),d=r(63),u=r(4269);function f(){var e;let t=(0,d.useParams)(),[r,l]=(0,i.useState)(null),[f,p]=(0,i.useState)([]),[m,h]=(0,i.useState)(""),[y,b]=(0,i.useState)(!1),x=!!(null==(e=(0,n.Cy)())?void 0:e.currentUser);(0,i.useEffect)(()=>{!async function(){let e,r=(0,n.Lf)();if(!r)return;let a=(0,s.H9)(r,"prompts",t.id);try{let t=performance.now();e=await (0,s.nY)(a);let r=performance.now();console.debug("[perf] prompt cache fetch ".concat(Math.round(r-t),"ms"))}catch(t){e=await (0,s._e)(a)}if(e.exists()){let t=e.data();l({id:e.id,title:t.title||"",body:t.body||"",tags:t.tags||[],sourceUrl:t.sourceUrl||null,visibility:t.visibility||"public",ownerId:t.ownerId,forkOf:t.forkOf,checksum:t.checksum});try{await (0,s.mZ)(a,{"stats.views":(0,s.GV)(1)})}catch(e){}}let i=(0,n.Cy)(),c=null==i?void 0:i.currentUser;c&&(p((await (0,s.GG)((0,s.P)((0,s.rJ)(r,"collections"),(0,s._M)("ownerId","==",c.uid)))).docs.map(e=>({id:e.id,title:e.data().title||""}))),b((await (0,s.x7)((0,s.H9)(r,"users",c.uid,"favorites",t.id))).exists()))}()},[t.id]);let v=(0,i.useMemo)(()=>{if(!(null==r?void 0:r.body))return[];let e=new Set;for(let t of r.body.matchAll(/\{\{([^}]+)\}\}/g))e.add(t[1].trim());return Array.from(e)},[r]),[g,w]=(0,i.useState)({});function N(e){return(e||"").replace(/\{\{([^}]+)\}\}/g,(e,t)=>{var r;return null!=(r=g[t.trim()])?r:"{{".concat(t,"}}")})}let j=(0,i.useMemo)(()=>r?(0,o.r)({title:r.title,body:N(r.body),tags:r.tags||[],sourceUrl:r.sourceUrl||null,visibility:r.visibility||"public"}):"",[r,g,N]);return r?(0,a.jsxs)("div",{className:"mx-auto max-w-[900px] py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsx)("h1",{className:"font-display text-2xl",children:r.title}),(0,a.jsxs)("div",{className:"relative z-50 flex gap-2 text-sm pointer-events-auto",children:[(0,a.jsx)("button",{onClick:async()=>{await (0,u.l)(N(r.body));try{let e=(0,n.Lf)();e&&await (0,s.mZ)((0,s.H9)(e,"prompts",t.id),{"stats.copies":(0,s.GV)(1)})}catch(e){}},className:"text-[var(--gh-cyan)] cursor-pointer",type:"button",children:"Copy Prompt"}),(0,a.jsx)("button",{onClick:async()=>{let e=JSON.stringify({title:r.title,body:N(r.body),tags:r.tags||[],sourceUrl:r.sourceUrl||null,visibility:r.visibility||"public"});await (0,u.l)(e)},className:"text-[var(--gh-cyan)] cursor-pointer",type:"button",children:"Copy JSON"}),(0,a.jsx)("button",{onClick:()=>(0,u.l)(j),className:"text-[var(--gh-cyan)] cursor-pointer",type:"button",children:"Copy Share Code"}),(0,a.jsx)("button",{onClick:async()=>{let e='<iframe src="'.concat(window.location.origin,"/embed/p/").concat(t.id,'" width="600" height="200" frameborder="0" style="max-width:100%;"></iframe>');await (0,u.l)(e)},className:"text-[var(--gh-cyan)] cursor-pointer",type:"button",children:"Copy Embed"}),(0,a.jsx)(c(),{href:"/p/".concat(t.id),className:"text-[var(--gh-cyan)]",children:"Share URL"}),(()=>{var e;let i=(0,n.Cy)(),s=null==i||null==(e=i.currentUser)?void 0:e.uid;return s&&r.ownerId===s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c(),{href:"/p/".concat(t.id,"/edit"),className:"text-[var(--gh-cyan)]",children:"Edit"}),(0,a.jsx)(c(),{href:"/p/".concat(t.id,"/versions"),className:"text-[var(--gh-cyan)]",children:"Versions"})]}):null})(),x&&(0,a.jsx)("button",{onClick:async()=>{try{let e=(0,n.Lf)(),r=(0,n.Cy)(),a=null==r?void 0:r.currentUser;if(!e||!a)return;let i=(0,s.H9)(e,"users",a.uid,"favorites",t.id);y?(await (0,s.kd)(i),b(!1),await (0,s.mZ)((0,s.H9)(e,"prompts",t.id),{"stats.likes":(0,s.GV)(-1)})):(await (0,s.BN)(i,{promptId:t.id,createdAt:new Date}),b(!0),await (0,s.mZ)((0,s.H9)(e,"prompts",t.id),{"stats.likes":(0,s.GV)(1)}))}catch(e){}},className:"text-[var(--gh-cyan)] pointer-events-auto",children:y?"★ Liked":"☆ Like"}),x&&(0,a.jsx)("button",{onClick:async()=>{try{let e=(0,n.Lf)(),a=(0,n.Cy)(),i=null==a?void 0:a.currentUser;if(!e||!i||!r)return;let l=(0,s.H9)((0,s.rJ)(e,"prompts"));await (0,s.BN)(l,{title:r.title,body:r.body,tags:r.tags||[],sourceUrl:r.sourceUrl||null,visibility:"private",ownerId:i.uid,forkOf:t.id,checksum:r.checksum||"fork",stats:{views:0,copies:0,likes:0},createdAt:(0,s.O5)(),updatedAt:(0,s.O5)()}),window.location.href="/p/".concat(l.id)}catch(e){}},className:"text-[var(--gh-cyan)] pointer-events-auto",children:"Fork"})]})]}),x&&f.length>0&&(0,a.jsxs)("div",{className:"mt-3 text-sm flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-[var(--gh-text-muted)]",children:"Add to collection:"}),(0,a.jsxs)("select",{className:"rounded-[10px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-2 py-1",onChange:async e=>{let r=e.target.value;if(r)try{h("Adding...");let e=(0,n.Lf)();if(!e)throw Error("No DB");await (0,s.BN)((0,s.H9)(e,"collections",r,"items",t.id),{promptId:t.id,addedAt:new Date}),h("Added")}catch(e){h(e instanceof Error?e.message:"Failed")}},defaultValue:"",children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"Select collection"}),f.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]}),m&&(0,a.jsx)("span",{className:"text-[var(--gh-text-muted)]",children:m})]}),(0,a.jsxs)("div",{className:"mt-4 text-[var(--gh-text-dim)] text-sm",children:["Visibility: ",r.visibility,r.forkOf&&(0,a.jsxs)(a.Fragment,{children:[" • ",(0,a.jsx)("span",{children:"Forked from "}),(0,a.jsx)(c(),{className:"text-[var(--gh-cyan)] underline",href:"/p/".concat(r.forkOf),children:r.forkOf})]}),r.sourceUrl&&(0,a.jsxs)(a.Fragment,{children:[" • ",(0,a.jsx)("a",{href:r.sourceUrl,target:"_blank",rel:"noreferrer",className:"underline text-[var(--gh-cyan)]",children:"source"})]})]}),v.length>0&&(0,a.jsx)("div",{className:"mt-6 grid gap-3 sm:grid-cols-2",children:v.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs mb-1 text-[var(--gh-text-muted)]",children:e}),(0,a.jsx)("input",{value:g[e]||"",onChange:t=>w({...g,[e]:t.target.value}),className:"w-full rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm",placeholder:"Enter ".concat(e)})]},e))}),(0,a.jsx)("pre",{className:"mt-6 p-4 rounded-[12px] bg-[var(--gh-bg-soft)] border border-[var(--gh-border)] whitespace-pre-wrap text-sm",children:N(r.body)}),Array.isArray(r.tags)&&r.tags.length>0&&(0,a.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:r.tags.map(e=>(0,a.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full bg-[var(--gh-bg-soft)] border border-[var(--gh-border)] text-[var(--gh-text-muted)]",children:["#",e]},e))})]}):(0,a.jsx)("div",{className:"py-8",children:"Loading…"})}}},e=>{e.O(0,[135,965,33,31,619,598,441,255,358],()=>e(e.s=8431)),_N_E=e.O()}]);