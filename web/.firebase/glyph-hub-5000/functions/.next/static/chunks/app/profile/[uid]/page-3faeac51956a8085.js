(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[139],{63:(e,t,s)=>{"use strict";var r=s(7260);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},4585:(e,t,s)=>{"use strict";s.d(t,{Cy:()=>x,Lf:()=>m});var r=s(2078),l=s(2553),a=s(9708);s(9996);let i=null,d=null,n=!1,c={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"glyph-hub-5000.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"glyph-hub-5000",NEXT_PUBLIC_FIREBASE_APP_ID:"1:58219751174:web:18337f5441f6cf1f06a087"};function u(){return Object.entries(c).filter(e=>{let[,t]=e;return!t}).map(e=>{let[t]=e;return t})}function o(){return i||(0!==u().length?(n||(n=!0,console.warn("[firebase] Missing Firebase env vars. Add web/.env.local with NEXT_PUBLIC_ keys. Missing:",u())),null):i=(0,r.Dk)().length?(0,r.Sx)():(0,r.Wp)({apiKey:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",authDomain:"glyph-hub-5000.firebaseapp.com",projectId:"glyph-hub-5000",storageBucket:"glyph-hub-5000.firebasestorage.app",messagingSenderId:"58219751174",appId:"1:58219751174:web:18337f5441f6cf1f06a087",measurementId:"G-N4T4Z5ZTL6"}))}function x(){let e=o();if(!e)return null;if(d)return d;try{d=(0,l.xI)(e)}catch(t){d=(0,l.Nu)(e,{persistence:[l.Gt,l.F0,l.iM]})}return d}function m(){let e=o();if(!e)return null;try{return(0,a._A)(e,{localCache:(0,a.vK)({tabManager:(0,a.K7)()})})}catch(t){return(0,a.aU)(e)}}},5667:(e,t,s)=>{Promise.resolve().then(s.bind(s,7954))},7954:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(5155),l=s(2115),a=s(63),i=s(4585),d=s(9708),n=s(2619),c=s.n(n),u=s(2553);function o(){var e,t,s,n;let o=(0,a.useParams)(),[m,h]=(0,l.useState)(null),[b,p]=(0,l.useState)([]),[v,g]=(0,l.useState)([]),[f,y]=(0,l.useState)([]),[N,j]=(0,l.useState)(null),[_,S]=(0,l.useState)(null),w=_===o.uid,[E,I]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{var e;let t=(0,i.Cy)();if(S((null==t||null==(e=t.currentUser)?void 0:e.uid)||null),t){let e=(0,u.iZ)(t,e=>S((null==e?void 0:e.uid)||null));return()=>e()}},[]),(0,l.useEffect)(()=>{!async function(){try{let e=(0,i.Lf)();if(!e)return;let t=await (0,d.x7)((0,d.H9)(e,"users",o.uid));t.exists()&&h(t.data());let s=await (0,d.GG)((0,d.P)((0,d.rJ)(e,"prompts"),(0,d._M)("ownerId","==",o.uid),(0,d._M)("visibility","==","public")));if(p(s.docs.map(e=>({id:e.id,...e.data()}))),_&&_===o.uid){let t=(await (0,d.GG)((0,d.P)((0,d.rJ)(e,"prompts"),(0,d._M)("ownerId","==",o.uid)))).docs.map(e=>({id:e.id,...e.data()}));g(t.filter(e=>"public"!==e.visibility))}else g([]);let r=await (0,d.GG)((0,d.P)((0,d.rJ)(e,"collections"),(0,d._M)("ownerId","==",o.uid),(0,d._M)("visibility","==","public")));y(r.docs.map(e=>({id:e.id,...e.data()})))}catch(e){j(e instanceof Error?e.message:"Failed to load profile")}}()},[o.uid,_]),N)?(0,r.jsx)("div",{className:"mx-auto max-w-[900px] py-8 text-red-400 text-sm",children:N}):(0,r.jsxs)("div",{className:"mx-auto max-w-[900px] py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h1",{className:"font-display text-2xl",children:(null==m?void 0:m.displayName)||"User"}),w&&(0,r.jsx)("button",{onClick:()=>I(e=>!e),className:"rounded-[10px] px-3 py-2 text-sm border border-[var(--gh-border)]",children:E?"Close editor":"Edit profile"})]}),(0,r.jsxs)("div",{className:"mb-6 p-4 rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)]",children:[(null==m?void 0:m.bio)&&(0,r.jsx)("p",{className:"text-sm mb-2",children:m.bio}),(0,r.jsxs)("div",{className:"text-xs text-[var(--gh-text-muted)]",children:[(0,r.jsxs)("span",{children:["Theme: ",(null==m||null==(e=m.preferences)?void 0:e.theme)||"system"]}),(0,r.jsxs)("span",{children:[" • Default visibility: ",(null==m||null==(t=m.preferences)?void 0:t.defaultVisibility)||"public"]})]})]}),w&&E&&(0,r.jsx)(x,{initial:{displayName:(null==m?void 0:m.displayName)||"",bio:(null==m?void 0:m.bio)||"",theme:(null==m||null==(s=m.preferences)?void 0:s.theme)||"system",defaultVisibility:(null==m||null==(n=m.preferences)?void 0:n.defaultVisibility)||"public"},onSaved:e=>h(t=>({...t||{},displayName:e.displayName,bio:e.bio,preferences:{...(null==t?void 0:t.preferences)||{},theme:e.theme,defaultVisibility:e.defaultVisibility}}))}),(0,r.jsx)("h2",{className:"font-display text-xl mb-3",children:"Public Prompts"}),(0,r.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[b.map(e=>(0,r.jsxs)(c(),{href:"/p/".concat(e.id),className:"rounded-[14px] p-4 bg-[var(--gh-surface)] border border-[var(--gh-border)]",children:[(0,r.jsx)("div",{className:"font-medium",children:e.title}),(0,r.jsx)("div",{className:"text-xs text-[var(--gh-text-muted)]",children:(e.tags||[]).join(", ")})]},e.id)),0===b.length&&(0,r.jsx)("div",{className:"text-sm text-[var(--gh-text-muted)]",children:"No public prompts."})]}),w&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"font-display text-xl mt-8 mb-3",children:"My Drafts & Forks"}),(0,r.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[v.map(e=>(0,r.jsxs)(c(),{href:"/p/".concat(e.id),className:"rounded-[14px] p-4 bg-[var(--gh-surface)] border border-[var(--gh-border)]",children:[(0,r.jsx)("div",{className:"font-medium",children:e.title}),(0,r.jsx)("div",{className:"text-xs text-[var(--gh-text-muted)]",children:e.visibility||"private"})]},e.id)),0===v.length&&(0,r.jsx)("div",{className:"text-sm text-[var(--gh-text-muted)]",children:"No private or unlisted prompts."})]})]}),(0,r.jsx)("h2",{className:"font-display text-xl mt-8 mb-3",children:"Public Collections"}),(0,r.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[f.map(e=>(0,r.jsx)(c(),{href:"/collections/".concat(e.id),className:"rounded-[14px] p-4 bg-[var(--gh-surface)] border border-[var(--gh-border)]",children:(0,r.jsx)("div",{className:"font-medium",children:e.title})},e.id)),0===f.length&&(0,r.jsx)("div",{className:"text-sm text-[var(--gh-text-muted)]",children:"No public collections."})]})]})}function x(e){let{initial:t,onSaved:s}=e,[a,n]=(0,l.useState)(t.displayName),[c,o]=(0,l.useState)(t.bio),[x,m]=(0,l.useState)(t.theme),[h,b]=(0,l.useState)(t.defaultVisibility),[p,v]=(0,l.useState)(!1),[g,f]=(0,l.useState)(null);async function y(){v(!0),f(null);try{var e,t,r;let l=null==(t=(0,i.Cy)())||null==(e=t.currentUser)?void 0:e.uid;if(!l)throw Error("Sign in");let n=(0,i.Lf)();if(!n)throw Error("No db");await (0,d.BN)((0,d.H9)(n,"users",l),{displayName:a||"",bio:c||"",preferences:{theme:x,defaultVisibility:h},updatedAt:(0,d.O5)()},{merge:!0});try{let e=null==(r=(0,i.Cy)())?void 0:r.currentUser;e&&await (0,u.r7)(e,{displayName:a||""})}catch(e){}s({displayName:a,bio:c,theme:x,defaultVisibility:h}),f("Saved")}catch(e){f(e instanceof Error?e.message:"Failed")}finally{v(!1)}}return(0,r.jsxs)("div",{className:"mb-8 p-4 rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)]",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs mb-1 text-[var(--gh-text-muted)]",children:"Display name"}),(0,r.jsx)("input",{value:a,onChange:e=>n(e.target.value),className:"w-full rounded-[10px] bg-[var(--gh-bg-soft)] border border-[var(--gh-border)] px-3 py-2 text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs mb-1 text-[var(--gh-text-muted)]",children:"Theme"}),(0,r.jsxs)("select",{value:x,onChange:e=>m(e.target.value),className:"w-full rounded-[10px] bg-[var(--gh-bg-soft)] border border-[var(--gh-border)] px-3 py-2 text-sm",children:[(0,r.jsx)("option",{value:"system",children:"System"}),(0,r.jsx)("option",{value:"light",children:"Light"}),(0,r.jsx)("option",{value:"dark",children:"Dark"})]})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-xs mb-1 text-[var(--gh-text-muted)]",children:"Bio"}),(0,r.jsx)("textarea",{value:c,onChange:e=>o(e.target.value),className:"w-full min-h-[100px] rounded-[10px] bg-[var(--gh-bg-soft)] border border-[var(--gh-border)] px-3 py-2 text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs mb-1 text-[var(--gh-text-muted)]",children:"Default visibility"}),(0,r.jsxs)("select",{value:h,onChange:e=>b(e.target.value),className:"w-full rounded-[10px] bg-[var(--gh-bg-soft)] border border-[var(--gh-border)] px-3 py-2 text-sm",children:[(0,r.jsx)("option",{value:"public",children:"Public"}),(0,r.jsx)("option",{value:"unlisted",children:"Unlisted"}),(0,r.jsx)("option",{value:"private",children:"Private"})]})]})]}),(0,r.jsxs)("div",{className:"mt-3 flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:y,disabled:p,className:"rounded-[10px] px-3 py-2 text-sm bg-[var(--gh-cyan)] text-black",children:p?"Saving…":"Save settings"}),g&&(0,r.jsx)("span",{className:"text-sm text-[var(--gh-text-muted)]",children:g})]})]})}}},e=>{e.O(0,[135,965,31,619,441,255,358],()=>e(e.s=5667)),_N_E=e.O()}]);