(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[359],{2943:(e,t,r)=>{"use strict";r.d(t,{BO:()=>s,ES:()=>n,Tk:()=>i,Uz:()=>a});var l=r(598);let a=l.Ikc({title:l.YjP().min(1,"Title is required").max(200),body:l.YjP().min(1,"Body is required").max(5e3),tags:l.YOg(l.YjP()).default([]),sourceUrl:l.YjP().url().nullable().optional().default(null),visibility:l.k5n(["public","unlisted","private"]).default("public")});function i(e){let t=e.title.trim(),r=e.body.replace(/\r\n/g,"\n").trim(),l=Array.from(new Set((e.tags||[]).map(e=>e.trim().toLowerCase()))).sort();return{title:t,body:r,tags:l,sourceUrl:e.sourceUrl||null,visibility:e.visibility||"public"}}let n=l.Ikc({title:l.YjP().min(1,"Title is required").max(120),visibility:l.k5n(["public","private"]).default("private")});function s(e){return{title:e.title.trim(),visibility:e.visibility||"private"}}},4152:(e,t,r)=>{"use strict";r.d(t,{d_:()=>a});let l=e=>crypto.getRandomValues(new Uint8Array(e)),a=(e,t=21)=>((e,t,r)=>{let l=(2<<Math.log2(e.length-1))-1,a=-~(1.6*l*t/e.length);return (i=t)=>{let n="";for(;;){let t=r(a),s=0|a;for(;s--;)if((n+=e[t[s]&l]||"").length>=i)return n}}})(e,0|t,l)},4269:(e,t,r)=>{"use strict";r.d(t,{f:()=>a,l:()=>i});let l=["spamword1","nsfw"];function a(e){let t=(e||"").toLowerCase();for(let e of l)if(e&&t.includes(e))return e;return null}async function i(e){try{if(navigator.clipboard&&window.isSecureContext)return void await navigator.clipboard.writeText(e)}catch(e){}let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-9999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}finally{document.body.removeChild(t)}}},4585:(e,t,r)=>{"use strict";r.d(t,{Cy:()=>f,Lf:()=>p});var l=r(2078),a=r(2553),i=r(9708);r(9996);let n=null,s=null,o=!1,c={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"glyph-hub-5000.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"glyph-hub-5000",NEXT_PUBLIC_FIREBASE_APP_ID:"1:58219751174:web:18337f5441f6cf1f06a087"};function u(){return Object.entries(c).filter(e=>{let[,t]=e;return!t}).map(e=>{let[t]=e;return t})}function d(){return n||(0!==u().length?(o||(o=!0,console.warn("[firebase] Missing Firebase env vars. Add web/.env.local with NEXT_PUBLIC_ keys. Missing:",u())),null):n=(0,l.Dk)().length?(0,l.Sx)():(0,l.Wp)({apiKey:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",authDomain:"glyph-hub-5000.firebaseapp.com",projectId:"glyph-hub-5000",storageBucket:"glyph-hub-5000.firebasestorage.app",messagingSenderId:"58219751174",appId:"1:58219751174:web:18337f5441f6cf1f06a087",measurementId:"G-N4T4Z5ZTL6"}))}function f(){let e=d();if(!e)return null;if(s)return s;try{s=(0,a.xI)(e)}catch(t){s=(0,a.Nu)(e,{persistence:[a.Gt,a.F0,a.iM]})}return s}function p(){let e=d();if(!e)return null;try{return(0,i._A)(e,{localCache:(0,i.vK)({tabManager:(0,i.K7)()})})}catch(t){return(0,i.aU)(e)}}},5957:(e,t,r)=>{Promise.resolve().then(r.bind(r,7534))},6056:(e,t)=>{!function(e){"undefined"==typeof DO_NOT_EXPORT_CRC?e(t):e({})}(function(e){e.version="1.2.2";var t=function(){for(var e=0,t=Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1,t[r]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),r=function(e){var t=0,r=0,l=0,a="undefined"!=typeof Int32Array?new Int32Array(4096):Array(4096);for(l=0;256!=l;++l)a[l]=e[l];for(l=0;256!=l;++l)for(r=e[l],t=256+l;t<4096;t+=256)r=a[t]=r>>>8^e[255&r];var i=[];for(l=1;16!=l;++l)i[l-1]="undefined"!=typeof Int32Array?a.subarray(256*l,256*l+256):a.slice(256*l,256*l+256);return i}(t),l=r[0],a=r[1],i=r[2],n=r[3],s=r[4],o=r[5],c=r[6],u=r[7],d=r[8],f=r[9],p=r[10],b=r[11],g=r[12],h=r[13],m=r[14];e.table=t,e.bstr=function(e,r){for(var l=-1^r,a=0,i=e.length;a<i;)l=l>>>8^t[(l^e.charCodeAt(a++))&255];return~l},e.buf=function(e,r){for(var x=-1^r,v=e.length-15,y=0;y<v;)x=m[e[y++]^255&x]^h[e[y++]^x>>8&255]^g[e[y++]^x>>16&255]^b[e[y++]^x>>>24]^p[e[y++]]^f[e[y++]]^d[e[y++]]^u[e[y++]]^c[e[y++]]^o[e[y++]]^s[e[y++]]^n[e[y++]]^i[e[y++]]^a[e[y++]]^l[e[y++]]^t[e[y++]];for(v+=15;y<v;)x=x>>>8^t[(x^e[y++])&255];return~x},e.str=function(e,r){for(var l=-1^r,a=0,i=e.length,n=0,s=0;a<i;)(n=e.charCodeAt(a++))<128?l=l>>>8^t[(l^n)&255]:n<2048?l=(l=l>>>8^t[(l^(192|n>>6&31))&255])>>>8^t[(l^(128|63&n))&255]:n>=55296&&n<57344?(n=(1023&n)+64,s=1023&e.charCodeAt(a++),l=(l=(l=(l=l>>>8^t[(l^(240|n>>8&7))&255])>>>8^t[(l^(128|n>>2&63))&255])>>>8^t[(l^(128|s>>6&15|(3&n)<<4))&255])>>>8^t[(l^(128|63&s))&255]):l=(l=(l=l>>>8^t[(l^(224|n>>12&15))&255])>>>8^t[(l^(128|n>>6&63))&255])>>>8^t[(l^(128|63&n))&255];return~l}})},7239:(e,t,r)=>{"use strict";r.d(t,{r:()=>c});var l=r(1210),a=r(2943),i=r(6056),n=r.n(i),s=r(5376).Buffer;let o={encode:e=>s.from(e).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")};function c(e){let t=JSON.stringify((0,a.Tk)(a.Uz.parse(e))),r=(0,l.Kc)(new TextEncoder().encode(t)),i=o.encode(r),s=(n().buf(r)>>>0).toString(16).padStart(8,"0");return"PB1.".concat(i,".").concat(s)}},7534:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var l=r(5155),a=r(2115),i=r(598),n=r(2943),s=r(8875),o=r(4585),c=r(9708),u=r(4152),d=r(7239),f=r(4269);let p=(0,u.d_)("0123456789abcdefghijklmnopqrstuvwxyz",10);function b(){var e;let[t,r]=(0,a.useState)({title:"",body:"",tags:[],sourceUrl:null,visibility:"public"}),[u,b]=(0,a.useState)(null),[g,h]=(0,a.useState)(!1),[m,x]=(0,a.useState)(null);async function v(e){e.preventDefault(),b(null),h(!0);try{let e=(0,o.Cy)(),r=null==e?void 0:e.currentUser,l=n.Uz.parse(t),a=(0,n.Tk)(l),i=(0,s.n)(a.body),u=(0,f.f)(a.body);if(u)throw Error("Content not allowed: ".concat(u));let b=p(),g=(0,o.Lf)();if(!g)throw Error("Firebase is not configured. Add .env.local");if(r&&!(await (0,c.GG)((0,c.P)((0,c.rJ)(g,"prompts"),(0,c._M)("checksum","==",i)))).empty)throw Error("A similar prompt already exists. Consider forking it.");if(r){let e=(0,c.H9)((0,c.rJ)(g,"prompts"),b);await (0,c.BN)(e,{...a,ownerId:r.uid,checksum:i,stats:{views:0,copies:0,likes:0},createdAt:(0,c.O5)(),updatedAt:(0,c.O5)()})}else{let e=(0,c.H9)((0,c.rJ)(g,"prompts"),b);await (0,c.BN)(e,{...a,ownerId:"anon",checksum:i,stats:{views:0,copies:0,likes:0},createdAt:(0,c.O5)(),updatedAt:(0,c.O5)()})}r&&await (0,c.BN)((0,c.H9)(g,"users",r.uid),{lastCreateAt:(0,c.O5)()},{merge:!0});let h=(0,d.r)(a);x(h)}catch(e){if(e instanceof i.GaX){var r;b((null==(r=e.issues[0])?void 0:r.message)||"Validation error")}else e instanceof Error?b(e.message):b("Unknown error")}finally{h(!1)}}return(0,a.useEffect)(()=>{!async function(){var e;let t=(0,o.Cy)(),l=null==t||null==(e=t.currentUser)?void 0:e.uid;if(!l)return;let a=(0,o.Lf)();if(a)try{let e=await (0,c.x7)((0,c.H9)(a,"users",l));if(e.exists()){let t=e.data().preferences,l=null==t?void 0:t.defaultVisibility;l&&["public","unlisted","private"].includes(l)&&r(e=>({...e,visibility:l}))}}catch(e){}}()},[]),(0,l.jsxs)("div",{className:"mx-auto max-w-[900px] py-8",children:[(0,l.jsx)("h1",{className:"font-display text-2xl mb-4",children:"New Prompt"}),(()=>{{let e=sessionStorage.getItem("gh_new_prompt_draft");if(e)try{let l=JSON.parse(e);sessionStorage.removeItem("gh_new_prompt_draft"),t.title||t.body||r({title:l.title||"",body:l.body||"",tags:Array.isArray(l.tags)?l.tags:[],sourceUrl:l.sourceUrl||null,visibility:l.visibility||"public"})}catch(e){}}return null})(),(0,l.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm mb-1",children:"Title"}),(0,l.jsx)("input",{className:"w-full rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm placeholder:text-[var(--gh-text-muted)] focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/50",value:t.title,onChange:e=>r({...t,title:e.target.value}),placeholder:"Short title"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm mb-1",children:"Body"}),(0,l.jsx)("textarea",{className:"w-full min-h-[200px] rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm placeholder:text-[var(--gh-text-muted)] focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/50",value:t.body,onChange:e=>r({...t,body:e.target.value}),placeholder:"Paste the prompt..."})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm mb-1",children:"Tags (comma separated)"}),(0,l.jsx)("input",{className:"w-full rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm placeholder:text-[var(--gh-text-muted)] focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/50",value:t.tags.join(", "),onChange:e=>r({...t,tags:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)}),placeholder:"writing, brainstorming"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm mb-1",children:"Source URL (optional)"}),(0,l.jsx)("input",{className:"w-full rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm placeholder:text-[var(--gh-text-muted)] focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/50",value:null!=(e=t.sourceUrl)?e:"",onChange:e=>r({...t,sourceUrl:e.target.value||null}),placeholder:"https://..."})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm mb-1",children:"Visibility"}),(0,l.jsxs)("select",{className:"w-full rounded-[12px] bg-[var(--gh-surface)] border border-[var(--gh-border)] px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/50",value:t.visibility,onChange:e=>r({...t,visibility:e.target.value}),children:[(0,l.jsx)("option",{value:"public",children:"Public"}),(0,l.jsx)("option",{value:"unlisted",children:"Unlisted"}),(0,l.jsx)("option",{value:"private",children:"Private"})]})]})]}),u&&(0,l.jsx)("p",{className:"text-red-400 text-sm",children:u}),(0,l.jsx)("button",{type:"submit",disabled:g,className:"inline-flex items-center gap-2 rounded-[12px] px-4 py-2 text-sm font-medium transition bg-[var(--gh-cyan)] text-black hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-[color:var(--gh-cyan)]/60",children:g?"Savingâ€¦":"Save Prompt"})]}),m&&(0,l.jsxs)("div",{className:"mt-6 p-4 rounded-[12px] bg-[var(--gh-bg-soft)] border border-[var(--gh-border)]",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("h2",{className:"text-sm text-[var(--gh-text-dim)]",children:"Share Code"}),(0,l.jsx)("button",{onClick:()=>navigator.clipboard.writeText(m),className:"text-sm text-[var(--gh-cyan)]",children:"Copy"})]}),(0,l.jsx)("pre",{className:"overflow-x-auto text-sm",children:m})]})]})}},8875:(e,t,r)=>{"use strict";function l(e){let t=0x811c9dc5;for(let r=0;r<e.length;r++)t^=e.charCodeAt(r),t=(t>>>0)*0x1000193>>>0;return(t>>>0).toString(16).padStart(8,"0")}r.d(t,{n:()=>l})}},e=>{e.O(0,[135,965,33,31,598,441,255,358],()=>e(e.s=5957)),_N_E=e.O()}]);