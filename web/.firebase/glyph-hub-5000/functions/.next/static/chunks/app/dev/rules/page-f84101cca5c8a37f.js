(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[74],{828:(e,t,r)=>{Promise.resolve().then(r.bind(r,9787))},4585:(e,t,r)=>{"use strict";r.d(t,{Cy:()=>h,Lf:()=>b,c7:()=>f});var s=r(2078),l=r(2553),n=r(9708),i=r(9996);let a=null,c=null,u=!1,o={NEXT_PUBLIC_FIREBASE_API_KEY:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN:"glyph-hub-5000.firebaseapp.com",NEXT_PUBLIC_FIREBASE_PROJECT_ID:"glyph-hub-5000",NEXT_PUBLIC_FIREBASE_APP_ID:"1:58219751174:web:18337f5441f6cf1f06a087"};function d(){return Object.entries(o).filter(e=>{let[,t]=e;return!t}).map(e=>{let[t]=e;return t})}function p(){return a||(0!==d().length?(u||(u=!0,console.warn("[firebase] Missing Firebase env vars. Add web/.env.local with NEXT_PUBLIC_ keys. Missing:",d())),null):a=(0,s.Dk)().length?(0,s.Sx)():(0,s.Wp)({apiKey:"AIzaSyBVxbbtB8yqSycBKbVs4HpORCc69nexI8c",authDomain:"glyph-hub-5000.firebaseapp.com",projectId:"glyph-hub-5000",storageBucket:"glyph-hub-5000.firebasestorage.app",messagingSenderId:"58219751174",appId:"1:58219751174:web:18337f5441f6cf1f06a087",measurementId:"G-N4T4Z5ZTL6"}))}function h(){let e=p();if(!e)return null;if(c)return c;try{c=(0,l.xI)(e)}catch(t){c=(0,l.Nu)(e,{persistence:[l.Gt,l.F0,l.iM]})}return c}function b(){let e=p();if(!e)return null;try{return(0,n._A)(e,{localCache:(0,n.vK)({tabManager:(0,n.K7)()})})}catch(t){return(0,n.aU)(e)}}function f(){let e=p();return e?(0,i.c7)(e):null}},9787:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(5155),l=r(2115),n=r(4585),i=r(9708);function a(){let[e,t]=(0,l.useState)("Idle"),[r,a]=(0,l.useState)(null);async function c(){t("Testing public read..."),a(null);try{let e=(0,n.Lf)();if(!e)throw Error("No DB");let r=(0,i.H9)(e,"prompts","welcome-1");await (0,i.x7)(r),t("Public read OK")}catch(e){a(e instanceof Error?e.message:"Public read failed"),t("Failed")}}async function u(){t("Testing owner write..."),a(null);try{let e=(0,n.Cy)(),r=null==e?void 0:e.currentUser;if(!r)throw Error("Sign in required");let s=(0,n.Lf)();if(!s)throw Error("No DB");let l=(0,i.H9)((0,i.rJ)(s,"prompts"));await (0,i.BN)(l,{title:"Rules Test",body:"Owner write should be allowed",tags:[],sourceUrl:null,visibility:"private",ownerId:r.uid,checksum:"rules-test",stats:{views:0,copies:0,likes:0},createdAt:(0,i.O5)(),updatedAt:(0,i.O5)()}),t("Owner write OK")}catch(e){a(e instanceof Error?e.message:"Owner write failed"),t("Failed")}}async function o(){t("Testing unauthorized write (should fail)..."),a(null);try{let e=(0,n.Lf)();if(!e)throw Error("No DB");let r=(0,i.H9)((0,i.rJ)(e,"prompts"));await (0,i.BN)(r,{title:"Should fail",body:"No owner / not signed in",tags:[],sourceUrl:null,visibility:"private",ownerId:"someone-else",checksum:"fail",stats:{views:0,copies:0,likes:0},createdAt:(0,i.O5)(),updatedAt:(0,i.O5)()}),t("Unexpectedly succeeded")}catch(e){t("Unauthorized write correctly blocked")}}return(0,s.jsxs)("div",{className:"mx-auto max-w-[640px] py-10",children:[(0,s.jsx)("h1",{className:"font-display text-2xl mb-4",children:"Dev: Rules Test"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:c,className:"rounded-[12px] px-3 py-2 text-sm bg-[var(--gh-cyan)] text-black",children:"Public read"}),(0,s.jsx)("button",{onClick:u,className:"rounded-[12px] px-3 py-2 text-sm border border-[var(--gh-border)]",children:"Owner write"}),(0,s.jsx)("button",{onClick:o,className:"rounded-[12px] px-3 py-2 text-sm border border-[var(--gh-border)]",children:"Unauthorized write"})]}),(0,s.jsxs)("div",{className:"mt-4 text-sm",children:[(0,s.jsxs)("div",{children:["Status: ",e]}),r&&(0,s.jsx)("div",{className:"text-red-400",children:r})]})]})}}},e=>{e.O(0,[135,965,31,441,255,358],()=>e(e.s=828)),_N_E=e.O()}]);